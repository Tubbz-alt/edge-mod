define([
    "dcl/dcl",
    "knockout",
    "./ReviewValue",
    "./StixObjectTLP",
    "kotemplate!root-tgt:./templates/root-ExploitTarget.html",
    "kotemplate!list-tgt:./templates/list-ExploitTargets.html"
], function (declare, ko, ReviewValue, StixObjectTLP) {
    "use strict";

    return declare(StixObjectTLP, {
        constructor: function (data, stixPackage) {
            this.vulnerabilities = ko.computed(function () {
                return stixPackage.safeListGet(this.id(), this.data(), "vulnerabilities", "title");
            }, this);
            this.weaknesses = ko.computed(function () {
                return stixPackage.safeListGet(this.id(), this.data(), "weaknesses", "description");
            }, this);
            this.configurations = ko.computed(function () {
                return stixPackage.safeListGet(this.id(), this.data(), "configuration", "short_description");
            }, this);
            this.informationSource = ko.computed(function () {
                return stixPackage.safeValueGet(this.id(), this.data(), "information_source.identity.id");
            }, this);
            this.informationSourceDescription = ko.computed(function () {
                return stixPackage.safeValueGet(this.id(), this.data(), "information_source.description");
            }, this);
            this.relatedTargets = ko.computed(function () {
                return stixPackage.safeReferenceArrayGet(this.id(), this.data(), "related_exploit_targets.related_exploit_targets", "exploit_target.idref");
            }, this);
            this.potentialCOAs = ko.computed(function () {
                return stixPackage.safeReferenceArrayGet(this.id(), this.data(), "potential_coas.coas", "course_of_action.idref");
            }, this);
        }
    });
});
