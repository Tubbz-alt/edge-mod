{% extends "base.html" %}
{% load site_tags %}
{% load staticfiles %}
{% block head-title %}{{ main_title }}{% endblock %}
{% block head-content %}

    <style type="text/css">
    button.btn.btn-danger {
        background-color: #D9534F;
    }

    button.btn.btn-danger:hover, .btn.btn-danger:focus, .btn.btn-danger:active {
        background-color: #D2322D;
    }

    dl.dl-horizontal dd table {
        table-layout: fixed;
    }

    dl.dl-horizontal dd table th {
        width: 25%;
    }

    dl.dl-horizontal dd table th:nth-child(n+3) {
        width: auto;
    }

    dl.dl-horizontal dd table.cols-2 th:nth-child(n+2) {
        width: auto;
    }

    dd.text-danger, dd.text-warning {
        font-style: italic;
    }
    </style>

{% endblock %}

{% block body-content %}
    <div class="container">
        <div class="row" data-bind="template: 'header'"></div>
        <div class="row" data-bind="template: 'warning'"></div>
        <div class="row" data-bind="template: { name: 'root-' + type().code, data: root }"></div>
    </div>
{% endblock %}

{% block body-end %}
    <script type="text/html" id="header">
        <div class="col-sm-12">
            <h3 class="obj-title">
                <button type="button" class="btn btn-danger pull-right"
                        data-bind="click: onPublish">Publish<br>Externally</button>
                <img alt="" src="" data-bind="attr: {
                    src: '{% static "img/hex" %}/hex_'+type().code+'.png'
                }">
                <span data-bind="text: type().label"></span><br>
                <small data-bind="text: root().id"></small>
            </h3>
        </div>
    </script>

    <script type="text/html" id="warning">
        <div class="col-sm-12">
            {# inline styles because someone used !important in soltra.css #}
            <div class="panel panel-danger" style="border: 1px solid #EBCCD1 !important;">
                <div class="panel-heading" style="background-color:#F2DEDE !important;border-bottom:1px solid #EBCCD1 !important;color:#A94442 !important;">
                    Warning
                </div>
                <div class="panel-body" style="background-color: #ffffff !important;">
                    By clicking the <em>Publish Externally</em> button, you will be placing the information contained
                    within this package into the public domain. Before doing so, please consider carefully whether this
                    would expose sensitive data or damage CERT-UK's reputation.
                </div>
            </div>
        </div>
    </script>

    <script src="{% static 'js/moment.min.js' %}"></script>
    <script src="{% static 'js/stickytape.js' %}"></script>
    <script>
        var require = {
            baseUrl: "{% static 'js' %}",
            paths: {
                knockout: "knockout-3.1.0",
                "knockout-dragdrop": "knockout.dragdrop"
            },
            urlArgs: "{% spaceless %}{% include 'publisher-version.html' %}{% endspaceless %}"
        };
        var rootId = "{{ root_id }}";
        var stixPackage = {{ package.to_json|safe }};
    </script>
    <script src="{% static 'js/require.js' %}" data-main="publisher/main"></script>
{% endblock %}
