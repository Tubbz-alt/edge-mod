<template type="text/html" id="DetectionRulesPanel">
    <div data-bind="if: $data == $parent.section().value()">
        <div class="panel panel-default panel-builder">
            <div class="panel-heading">
                Detection Rules
                <button class="btn btn-default btn-xs btn-add"
                        data-bind="click: add, visible: $parent.mode().isEditable()">
                    <span class="glyphicon glyphicon-plus-sign green"></span> Add
                </button>
            </div>
            <div class="panel-body">
                <table data-bind="foreach: rules">
                    <tbody role="form">
                    <tr class="datarow">
                        <td>
                            <div class="form-horizontal">
                                <fieldset>
                                    <div class="form-group">
                                        <label class="col-lg-2 control-label">Type</label>
                                        <div class="col-lg-8">
                                            <select data-bind="options: $parent.options,
                                                               value: type"></select>
                                        </div>
                                        <span class="input-group-btn" data-bind="ifnot: $root.mode().isReadOnly()">
                                            <button type="button" class="btn btn-default" title="Remove this item"
                                                data-bind=" click: function() { $parent.remove($data) }">
                                                <span class="glyphicon glyphicon-remove"></span>
                                            </button>
                                            <button type="button" class="btn btn-default" data-bind="click: addRule">
                                                <span class="glyphicon glyphicon-plus"></span>
                                            </button>
                                        </span>
                                    </div>
                                    <div class="form-group">
                                        <!-- ko if: rules().length > 0 -->
                                        <label class="col-lg-2 control-label">Rules</label>
                                        <div class="col-lg-8" data-bind="foreach: rules">
                                            <div class="input-group">
                                                <input data-bind="value: rule, valueUpdate: 'afterkeydown', disable: $root.mode().isReadOnly()"
                                                class="form-control">
                                                <span class="input-group-btn">
                                                    <button class="btn btn-default" data-bind="click: $parent.removeRule.bind($parent, $index())">
                                                        <span class="glyphicon glyphicon-remove-circle"></span>
                                                    </button>
                                                </span>
                                            </div>
                                        </div>
                                        <!-- /ko -->
                                    </div>
                                </fieldset>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</template>
